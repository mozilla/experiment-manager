{% extends "experiments/section_base.html" %}

{% load experiment_extras %}

{% block section_title %}
  Branches ({{experiment.variants.count}})
{% endblock %}

{% block section_content %}
{% if not experiment.is_multi_pref %}
  {% if experiment.pref_type %}
  <strong>Pref Type</strong> <p>{{ experiment.pref_type }}</p>
  {% endif %}
  {% if experiment.pref_branch %}
  <strong>Pref Branch</strong> <p>{{ experiment.pref_branch }}</p>
  {% endif %}
{% endif %}
  {% for variant in experiment.variants.all %}
    <div class="border-left-grey pl-3 mb-4">
      <h5>{{ variant.ratio }}% {{ variant.name }}</h5>
      {% if experiment.is_multi_pref %}
        {% for preference in variant.preferences.all %}

          <div class="border-left-grey pl-3 ml-2">
            <p><strong> Pref Type = <span class="text-info">{{ preference.pref_type }}</span></strong></p>
            <p><strong> Pref Branch = <span class="text-info">{{ preference.pref_branch }}</span></strong></p>
            {% if preference.pref_type == "json string" %}
              <p><strong> {{ preference.pref_name }} = <span class="text-info">{{ preference.pref_value|as_json }}</span></strong></p>
            {% else %}
              <p><strong> {{ preference.pref_name }} = <span class="text-info">{{ preference.pref_value }}</span></strong></p>
            {% endif %}
          </div>
        {% endfor %}
      {% elif experiment.is_pref_experiment %}
        {% if experiment.pref_type == "json string" %}
          <p><strong>{{ experiment.pref_key }} = <pre class="text-info">{{ variant.value|as_json }}</pre></strong></p>
        {% else %}
          <p><strong>{{ experiment.pref_key }} = <span class="text-info">{{ variant.value }}</span></strong></p>
        {% endif %}
      {% endif %}
      <p>{{ variant.description|urlize|linebreaks }}</p>
      {% if experiment.is_branched_addon %}
        <p><strong>Addon Release URL: </strong></p>
        <p>{{ variant.addon_release_url|urlize }}</p>
      {% endif %}
    </div>
  {% endfor %}
{% endblock %}
